import{j as t,c as C,n as d,u as y,a as w,r as A,O as S,f as b}from"./index-Ck7621Tc.js";import{I as k,C as D,a as $}from"./InteractiveListItem-dfaFc_jS.js";import{f as E,P as F,I as O,s as P}from"./sortItems-iTEZoTFa.js";import{u as I,a as m}from"./useAppSelector.hook-Djmn2zyC.js";import{useNotesContext as L}from"./Notes-DbcfaDI2.js";import"./CustomSelect-36FKjkB1.js";import"./useTimeout-BM8AyNJZ.js";const B="_note__date_1w44a_14",M="_note__title_1w44a_28",R="_note_1w44a_14",T="_note__text_1w44a_74",K="_note__pin_1w44a_89",c={"visually-hidden":"_visually-hidden_1w44a_1",note__date:B,note__title:M,note:R,note__text:T,note__pin:K};function U({contextMenuItems:p,children:_,data:o,isSelection:l=!1,className:i,...f}){const r=I(),a=m(u=>u.settings).sort==="createDate"?o.createdAt:o.updatedAt;return t.jsxs(k,{...f,contextMenuItems:p,isSelection:l,className:C(c.note,i),children:[l&&t.jsx(D,{name:"note-select",className:c["note__select-checkbox"],appearance:"circle",checked:o.selected,tabIndex:-1,onChange:()=>r(d.toggleSelect(o.id))}),t.jsxs("div",{className:c.note__text,children:[t.jsx("span",{className:c.note__title,children:_}),t.jsx("span",{"aria-hidden":!0,className:c.note__date,children:E(O(a))}),o.pinned.state&&t.jsx(F,{className:c.note__pin})]})]})}const V={"visually-hidden":"_visually-hidden_m4pd8_1","notes-list":"_notes-list_m4pd8_14"};function X(){const{searchValue:p,isSelection:_,focusFromUpsertNoteRef:o,confirmAction:l}=L(),i=I(),f=m(e=>e.folders),r=y(),{folder:s}=w(),a=parseInt((s==null?void 0:s.split("-")[1])??"1"),u=m(e=>e.notes),x=m(e=>e.settings),g=P(u.items,x.sort).filter(e=>e.folderId.includes(a));A.useEffect(()=>{(s!=="all"&&a!==1&&!f.items.find(e=>e.id===a)||s!=="all"&&!a)&&r(-1)},[s]);const j=e=>{const n=e.selected?"Снять выделение":"Выделить",v=e.pinned.state?"Открепить":"Закрепить";return[{name:n,action:()=>i(d.toggleSelect(e.id))},{name:v,action:()=>i(d.togglePin(e.id))},{name:"Редактировать",action:()=>r(`/notes/${s}/note-${e.id}/edit`)},{name:"Удалить",action:()=>{x.actionConfirmations==="all"||x.actionConfirmations==="deleteOnly"?l({message:"Подтвердить удаление",onConfirm:N}):N();function N(){i(d.remove(e.id)),i(b.removeNotes({id:e.folderId[1]??e.folderId[0],notes:[e.id]}))}}}]},h=(e,n)=>{if(_){i(d.toggleSelect(n.id));return}o.current=e.currentTarget,r(`/notes/${s}/note-${n.id}/edit`)};return t.jsxs(t.Fragment,{children:[t.jsx($,{role:"tabpanel","aria-description":"Заметки",id:`note-folder-${a}`,className:V["notes-list"],isNotFocusable:g.length===0,children:g.filter(e=>e.title.toLowerCase().includes(p)).map(e=>t.jsx(U,{contextMenuItems:j(e),data:e,isSelection:_,onClick:n=>h(n,e),onKeyDown:n=>n.key==="Enter"&&h(n,e),children:e.title!==""?e.title:"Без заголовка"},e.id))}),t.jsx(S,{context:{focusFromUpsertNoteRef:o,confirmAction:l}})]})}export{X as default};
